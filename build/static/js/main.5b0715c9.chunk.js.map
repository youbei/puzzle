{"version":3,"sources":["reportWebVitals.js","components/Header/index.js","components/Nav/index.js","components/Container/index.js","pages/MergeImages/index.js","pages/CropImages/index.js","components/Modal/index.js","pages/Excel/MissingSku/index.js","pages/Excel/MissingSkuOrder/index.js","pages/Excel/MissingSkuProduct/index.js","pages/Excel/ReturnRatio/index.js","pages/Excel/UnpaidOrder/index.js","pages/Excel/PaidAndCancelled/index.js","pages/Excel/index.js","pages/Home/index.js","index.js"],"names":["reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","Index","className","to","CustomLink","children","props","resolved","useResolvedPath","match","useMatch","path","pathname","end","style","backgroundColor","color","Date","getFullYear","useState","imageList","setImageList","isDropOver","setIsDropOver","totalWidth","setTotalWidth","column","setColumn","padding","setPadding","isValid","useMemo","Number","dropHandler","e","preventDefault","p","reset","canvas","document","getElementById","getContext","clearRect","width","height","removeCanvas","i","dataTransfer","items","length","kind","type","file","getAsFile","push","processImages","Promise","all","list","resolve","reader","FileReader","addEventListener","img","Image","src","result","readAsDataURL","useEffect","tw","c","reduce","prev","current","row","Math","ceil","adjustedWidth","adjustedHeight","context","forEach","item","drawImage","floor","id","value","onChange","target","onClick","onDrop","onDragOver","dragOverHandler","onDragLeave","dragLeaveHandler","close","stopPropagation","keys","Object","map","index","order","sortByTotal","entries","sort","a","total","title","succeed","closed","toFixed","hasFiles","setHasFiles","sum","setSum","setSucceed","setClosed","orderDetail","setOrderDetail","unpaidOrder","setUnpaidOrder","paidAndCancelled","setPaidAndCancelled","fake","setFake","fakeSum","setFakeSum","totalCost","setTotalCost","missingSku","setMissingSku","missingSkuOrder","setMissingSkuOrder","missingSkuProduct","setMissingSkuProduct","showMissingSku","setShowMissingSku","showMissingSkuOrder","setShowMissingSkuOrder","showMissingSkuProduct","setShowMissingSkuProduct","showReturnRatio","setShowReturnRatio","showUnpaidOrder","setShowUnpaidOrder","showPaidAndCancelled","setShowPaidAndCancelled","files","skuSheet","orderSheet","productSheet","returnSheet","name","readFile","values","fakeOrder","products","returnDetail","isFakeOrder","l","payment","return","sku","slice","k","String","cost","shipping","j","longSku","split","s","isNaN","calc","readFiles","workbook","XLSX","read","Uint8Array","xlsxData","utils","sheet_to_json","Sheets","SheetNames","readAsArrayBuffer","mark","indexOf","returnRatio","buildResults","ReactDOM","render","StrictMode","element"],"mappings":"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","file":"static/js/main.5b0715c9.chunk.js","sourcesContent":["const reportWebVitals = onPerfEntry => {\n\tif (onPerfEntry && onPerfEntry instanceof Function) {\n\t\timport('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n\t\t\tgetCLS(onPerfEntry)\n\t\t\tgetFID(onPerfEntry)\n\t\t\tgetFCP(onPerfEntry)\n\t\t\tgetLCP(onPerfEntry)\n\t\t\tgetTTFB(onPerfEntry)\n\t\t})\n\t}\n}\n\nexport default reportWebVitals\n","import './index.scss'\nimport React from 'react'\nimport {\n\tLink,\n} from 'react-router-dom'\n\nfunction Index() {\n\treturn (\n\t\t<div className=\"header\">\n\t\t\t<div className=\"header-logo\">\n\t\t\t\t<Link to=\"/\">PUZZLE</Link>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Index\n","import './index.scss'\nimport React from 'react'\nimport {\n\tLink,\n\tuseMatch,\n\tuseResolvedPath\n} from 'react-router-dom'\n\nfunction CustomLink({ children, to, ...props }) {\n\tlet resolved = useResolvedPath(to)\n\tlet match = useMatch({ path: resolved.pathname, end: true })\n\n\treturn (\n\t\t<div>\n\t\t\t<Link\n\t\t\t\tstyle={ match ? { backgroundColor: 'rgba(170, 172, 247,.8)', color: '#fff'} : {backgroundColor: '#fff', color: '#000'}}\n\t\t\t\tto={to}\n\t\t\t\t{...props}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</Link>\n\t\t</div>\n\t)\n}\n\nfunction Index() {\n\treturn (\n\t\t<div className=\"nav\">\n\t\t\t<CustomLink to=\"/merge\" className=\"nav-item\">合并图片</CustomLink>\n\t\t\t<CustomLink to=\"/crop\" className=\"nav-item\">裁切图片</CustomLink>\n\t\t\t<CustomLink to=\"/excel\" className=\"nav-item\">表格统计</CustomLink>\n\t\t\t<div className=\"copyright\">{new Date().getFullYear()} 金又北</div>\n\t\t</div>\n\t)\n}\n\nexport default Index\n","import './index.scss'\nimport React from 'react'\nimport Nav from '../Nav'\n\nfunction Index(props) {\n\treturn (\n\t\t<div className=\"container\">\n\t\t\t<Nav />\n\t\t\t{props.children}\n\t\t</div>\n\t) \n}\n\nexport default Index\n","import './index.scss'\nimport React, {useState, useEffect, useMemo} from 'react'\nimport Header from '../../components/Header'\nimport Container from '../../components/Container'\n\nconst TOTAL_WIDTH = 750\nconst COLUMN = 3 \nconst PADDING = 10 \n\nfunction Index() {\n\tconst [imageList, setImageList] = useState([])\n\tconst [isDropOver, setIsDropOver] = useState(false)\n\tconst [totalWidth, setTotalWidth] = useState(TOTAL_WIDTH)\n\tconst [column, setColumn] = useState(COLUMN)\n\tconst [padding, setPadding] = useState(PADDING)\n\n\tconst isValid = useMemo(() => {\n\t\tif(Number(totalWidth) < 1 || Number(totalWidth) > 9999 || Number(column) < 1 || Number(column) > 9 || Number(padding) < 0 || Number(padding) > 20 ) {\n\t\t\treturn false\n\t\t}\n\t\treturn true\n\t}, [totalWidth, column, padding])\n\n\tuseEffect(() => {\n\t\tif (imageList.length === 0) {\n\t\t\treturn\n\t\t}\n\n\t\tif (!isValid) {\n\t\t\treturn\n\t\t}\n\n\t\tconst tw = Number(totalWidth)\n\t\tconst c = Number(column)\n\t\tconst p = Number(padding)\n\n\t\t// 找出所有图片中的最小宽度和高度\n\t\tconst width = imageList.reduce((prev, current) => (prev.width < current.width) ? prev : current).width\n\t\tconst height = imageList.reduce((prev, current) => (prev.height < current.height) ? prev : current).height\n\n\t\t// 计算有多少行\n\t\tconst row = Math.ceil(imageList.length / c)\n\n\t\t// 调整后的图片尺寸\n\t\tconst adjustedWidth = (tw - (c - 1) * p) / c\n\t\tconst adjustedHeight = adjustedWidth * height / width \n\n\t\tconst canvas = document.getElementById('canvas')\n\t\tconst context = canvas.getContext('2d')\n\t\tcanvas.width = tw\n\t\tcanvas.height = adjustedHeight * row + p * (row - 1)\n\n\t\timageList.forEach((item, i) => {\n\t\t\tcontext.drawImage(\n\t\t\t\titem, \n\t\t\t\t0, // x轴，从左侧多少像素开始裁切图片 \n\t\t\t\t0, // y轴，从顶部多少像素开始裁切图片 \n\t\t\t\twidth, // 裁切的图片的宽度 \n\t\t\t\theight, // 裁切图片的高度 \n\t\t\t\ti % c * (adjustedWidth + p), // x轴，当前图片离左侧多少像素\n\t\t\t\tMath.floor(i / c) * (adjustedHeight + p), // y轴，当前图片离顶部多少像素\n\t\t\t\tadjustedWidth, // 图片宽度缩小至多少像素 \n\t\t\t\tadjustedHeight // 图片高度缩小至多少像素\n\t\t\t)\n\t\t})\n\t}, [imageList, totalWidth, column, padding, isValid])\n\n\tfunction dropHandler(e) {\n\t\te.preventDefault()\n\t\tsetIsDropOver(false)\n\t\tsetImageList([])\n\t\tlet p = []\n\n\t\tif(!isValid) {\n\t\t\treset()\n\t\t}\n\n\t\tremoveCanvas()\n\n\t\tfor (let i = 0; i < e.dataTransfer.items.length; i++) {\n\t\t\tif (e.dataTransfer.items[i].kind === 'file' && e.dataTransfer.items[i].type.match('^image/')) {\n\t\t\t\tconst file = e.dataTransfer.items[i].getAsFile()\n\t\t\t\tp.push(processImages(file))\n\t\t\t}\n\t\t}\n\n\t\tPromise.all(p).then(list => setImageList(list))\n\t}\n\n\tfunction processImages(file) {\n\t\treturn new Promise(resolve => {\n\t\t\tconst reader = new FileReader()\n\t\t\treader.addEventListener('load', () => {\n\t\t\t\tconst img = new Image()\n\t\t\t\timg.src = reader.result\n\t\t\t\timg.addEventListener('load', () => {\n\t\t\t\t\tresolve(img)\n\t\t\t\t})\n\t\t\t}, false)\n\t\t\treader.readAsDataURL(file)\n\t\t})\n\t}\n\n\tfunction reset() {\n\t\tsetTotalWidth(TOTAL_WIDTH)\n\t\tsetColumn(COLUMN)\n\t\tsetPadding(PADDING)\n\t}\n\n\tfunction removeCanvas() {\n\t\tconst canvas = document.getElementById('canvas')\n\t\tconst context = canvas.getContext('2d')\n\t\tcontext.clearRect(0, 0, canvas.width, canvas.height)\n\t}\n\n\tfunction dragOverHandler(e) {\n\t\tsetIsDropOver(true)\n\t\te.preventDefault()\n\t}\n\n\tfunction dragLeaveHandler(e) {\n\t\tsetIsDropOver(false)\n\t\te.preventDefault()\n\t}\n\n\treturn (\n\t\t<div className=\"merge-images\">\n\t\t\t<Header />\n\t\t\t<Container>\n\t\t\t\t<div className=\"merge-images-container\">\n\t\t\t\t\t<div className=\"merge-images-container-left\">\n\t\t\t\t\t\t<canvas id=\"canvas\"></canvas>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"merge-images-container-right\">\n\t\t\t\t\t\t<div className=\"merge-images-container-right-top\">\n\t\t\t\t\t\t\t<div className=\"merge-images-container-right-top-item\">\n\t\t\t\t\t\t\t\t<p>图片宽度</p>\n\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\t\t\t\tvalue={totalWidth}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setTotalWidth(e.target.value) }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"merge-images-container-right-top-item\">\n\t\t\t\t\t\t\t\t<p>每行个数</p>\n\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\t\t\t\tvalue={column}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setColumn(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"merge-images-container-right-top-item\">\n\t\t\t\t\t\t\t\t<p>图片间隔</p>\n\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\t\t\t\tvalue={padding}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setPadding(e.target.value)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\tonClick={() => reset()}\n\t\t\t\t\t\t\t\tclassName=\"merge-images-container-right-top-item\"\n\t\t\t\t\t\t\t>重置</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclassName=\"merge-images-container-right-bottom\"\n\t\t\t\t\t\t\tstyle={isDropOver ? { backgroundColor: 'rgba(170, 172, 247,.8)', color: '#fff'} : {}}\n\t\t\t\t\t\t\tonDrop={(e) => dropHandler(e)} \n\t\t\t\t\t\t\tonDragOver={(e) => dragOverHandler(e)}\n\t\t\t\t\t\t\tonDragLeave={(e) => dragLeaveHandler(e)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<h1>把图片拖到这里</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Container>\n\t\t</div>\n\t)\n}\n\nexport default Index\n","import './index.scss'\nimport React from 'react'\nimport Header from '../../components/Header'\nimport Container from '../../components/Container'\n\nfunction Index() {\n\treturn (\n\t\t<div className=\"crop-images\">\n\t\t\t<Header />\n\t\t\t<Container>\n\t\t\t\t<div className=\"crop-images-container\">\n\t\t\t\t\t<section className=\"advice\">\n\t\t\t\t\t\t<h1 className=\"advice__title\">建设中。</h1>\n\t\t\t\t\t</section>\n\t\t\t\t\t<section className=\"city-stuff\">\n\t\t\t\t\t\t<ul className=\"skyscrappers__list\">\n\t\t\t\t\t\t\t<li className=\"skyscrapper__item skyscrapper-1\"></li>\n\t\t\t\t\t\t\t<li className=\"skyscrapper__item skyscrapper-2\"></li>\n\t\t\t\t\t\t\t<li className=\"skyscrapper__item skyscrapper-3\"></li>\n\t\t\t\t\t\t\t<li className=\"skyscrapper__item skyscrapper-4\"></li>\n\t\t\t\t\t\t\t<li className=\"skyscrapper__item skyscrapper-5\"></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<ul className=\"tree__container\">\n\t\t\t\t\t\t\t<li className=\"tree__list\">\n\t\t\t\t\t\t\t\t<ul className=\"tree__item tree-1\">\n\t\t\t\t\t\t\t\t\t<li className=\"tree__trunk\"></li>\n\t\t\t\t\t\t\t\t\t<li className=\"tree__leaves\"></li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t<ul className=\"tree__item tree-2\">\n\t\t\t\t\t\t\t\t\t<li className=\"tree__trunk\"></li>\n\t\t\t\t\t\t\t\t\t<li className=\"tree__leaves\"></li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t<ul className=\"tree__item tree-3\">\n\t\t\t\t\t\t\t\t\t<li className=\"tree__trunk\"></li>\n\t\t\t\t\t\t\t\t\t<li className=\"tree__leaves\"></li>\n\t\t\t\t\t\t\t\t</ul>  \n\t\t\t\t\t\t\t\t<ul className=\"tree__item tree-4\">\n\t\t\t\t\t\t\t\t\t<li className=\"tree__trunk\"></li>\n\t\t\t\t\t\t\t\t\t<li className=\"tree__leaves\"></li>\n\t\t\t\t\t\t\t\t</ul>  \n\t\t\t\t\t\t\t\t<ul className=\"tree__item tree-5\">\n\t\t\t\t\t\t\t\t\t<li className=\"tree__trunk\"></li>\n\t\t\t\t\t\t\t\t\t<li className=\"tree__leaves\"></li>\n\t\t\t\t\t\t\t\t</ul>  \n\t\t\t\t\t\t\t\t<ul className=\"tree__item tree-6\">\n\t\t\t\t\t\t\t\t\t<li className=\"tree__trunk\"></li>\n\t\t\t\t\t\t\t\t\t<li className=\"tree__leaves\"></li>\n\t\t\t\t\t\t\t\t</ul>  \n\t\t\t\t\t\t\t\t<ul className=\"tree__item tree-7\">\n\t\t\t\t\t\t\t\t\t<li className=\"tree__trunk\"></li>\n\t\t\t\t\t\t\t\t\t<li className=\"tree__leaves\"></li>\n\t\t\t\t\t\t\t\t</ul>  \n\t\t\t\t\t\t\t\t<ul className=\"tree__item tree-8\">\n\t\t\t\t\t\t\t\t\t<li className=\"tree__trunk\"></li>\n\t\t\t\t\t\t\t\t\t<li className=\"tree__leaves\"></li>\n\t\t\t\t\t\t\t\t</ul>  \n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<ul className=\"crane__list crane-1\">\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-1\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-2\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-3\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-stand\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-weight\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cabin\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-arm\"></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<ul className=\"crane__list crane-2\">\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-1\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-2\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-3\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-stand\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-weight\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cabin\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-arm\"></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<ul className=\"crane__list crane-3\">\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-1\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-2\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cable crane-cable-3\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-stand\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-weight\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-cabin\"></li>\n\t\t\t\t\t\t\t<li className=\"crane__item crane-arm\"></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</section>\n\t\t\t\t</div>\n\t\t\t</Container>\n\t\t</div>\n\t)\n}\n\nexport default Index\n","import './index.scss'\nimport React from 'react'\n\nfunction Index(props) {\n\tconst { close, style, children } = props\n\treturn (\n\t\t<div className=\"modal\">\n\t\t\t<div className=\"modal-overlay\" onClick={() => close()}>\n\t\t\t\t<div className=\"modal-container\" onClick={(e) => { e.stopPropagation() }} style={style}>\n\t\t\t\t\t{children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Index\n","import './index.scss'\nimport React from 'react'\nimport Modal from '../../../components/Modal'\n\nfunction Index(props) {\n\tconst { close, list } = props\n\tconst keys = Object.keys(list)\n\treturn (\n\t\t<Modal close={close} style={{ width: '820px', height: keys.length >= 10 ? '602px' : `${keys.length * 60 + 2}px` }}>\n\t\t\t<div className=\"missing-sku\">\n\t\t\t\t{\n\t\t\t\t\tkeys.map((item, index) =>\n\t\t\t\t\t\t<div key={index} className=\"missing-sku-item\">\n\t\t\t\t\t\t\t<div className=\"missing-sku-item-left\">\n\t\t\t\t\t\t\t\t<p>{item}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"missing-sku-item-right\">\n\t\t\t\t\t\t\t\t<p>{list[item]}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</div>\n\t\t</Modal>\n\t)\n}\n\nexport default Index\n","import React from 'react'\nimport Modal from '../../../components/Modal'\nimport './index.scss'\n\nfunction Index(props) {\n\tconst { close, list } = props\n\tconst keys = Object.keys(list)\n\treturn (\n\t\t<Modal close={close} style={{ width: '820px', height: keys.length >= 10 ? '602px' : `${keys.length * 60 + 2}px` }}>\n\t\t\t<div className=\"missing-sku-order\">\n\t\t\t\t{\n\t\t\t\t\tkeys.map((order, index) =>\n\t\t\t\t\t\t<div key={index} className=\"missing-sku-order-item\">\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlist[order].map((item, index) =>\n\t\t\t\t\t\t\t\t\t<div className=\"missing-sku-order-subitem\" key={index}>\n\t\t\t\t\t\t\t\t\t\t<div className=\"missing-sku-order-item-left\">\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tindex === 0 &&\n\t\t\t\t\t\t\t\t\t\t\t\t<p>{order}</p>\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div className=\"missing-sku-order-item-right\">\n\t\t\t\t\t\t\t\t\t\t\t<p>{item}</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</div>\n\t\t</Modal>\n\t)\n}\n\nexport default Index\n\n\n","import React from 'react'\nimport Modal from '../../../components/Modal'\nimport './index.scss'\n\nfunction Index(props) {\n\tconst { close, list } = props\n\tconst keys = Object.keys(list)\n\treturn (\n\t\t<Modal close={close} style={{ width: '820px', height: keys.length >= 10 ? '602px' : `${keys.length * 60 + 2}px` }}>\n\t\t\t<div className=\"missing-sku-product\">\n\t\t\t\t{\n\t\t\t\t\tkeys.map((item, index) =>\n\t\t\t\t\t\t<div key={index} className=\"missing-sku-product-item\">\n\t\t\t\t\t\t\t{item}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</div>\n\t\t</Modal>\n\t)\n}\n\nexport default Index\n\n\n","import React from 'react'\nimport Modal from '../../../components/Modal'\nimport './index.scss'\n\nfunction Index(props) {\n\tconst { close, list } = props\n\tconst sortByTotal = Object.entries(list).sort(([, a], [, b]) => b.total - a.total)\n\n\treturn (\n\t\t<Modal close={close} style={{ width: '920px', height: '602px' }}>\n\t\t\t<div className=\"return\">\n\t\t\t\t<div className=\"return-item\">\n\t\t\t\t\t<div className=\"return-item-col-1 black white-line\">\n\t\t\t\t\t\t<p>宝贝</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"return-item-col-2 black white-line\">\n\t\t\t\t\t\t<p>净销量</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"return-item-col-3 black white-line\">\n\t\t\t\t\t\t<p>退货量</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"return-item-col-4 black\">\n\t\t\t\t\t\t<p>退货率</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{\n\t\t\t\t\tsortByTotal.map((item, index) =>\n\t\t\t\t\t\t<div key={index} className=\"return-item\">\n\t\t\t\t\t\t\t<div className=\"return-item-col-1\">\n\t\t\t\t\t\t\t\t<p>{item[1].title}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"return-item-col-2\">\n\t\t\t\t\t\t\t\t<p>{item[1].succeed}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"return-item-col-3\">\n\t\t\t\t\t\t\t\t<p>{item[1].closed}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"return-item-col-4\">\n\t\t\t\t\t\t\t\t<p>{`${(item[1].closed / item[1].total * 100).toFixed(2)}%`}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</div>\n\t\t</Modal>\n\t)\n}\n\nexport default Index\n\n\n","import React from 'react'\nimport Modal from '../../../components/Modal'\nimport './index.scss'\n\nfunction Index(props) {\n\tconst { close, list } = props\n\tconst keys = Object.keys(list)\n\treturn (\n\t\t<Modal close={close} style={{ width: '820px', height: keys.length >= 10 ? '602px' : `${keys.length * 60 + 2}px` }}>\n\t\t\t<div className=\"missing-sku-order\">\n\t\t\t\t<div className=\"missing-sku-order-item\">\n\t\t\t\t\t<div className=\"missing-sku-order-item-col black\">\n\t\t\t\t\t\t<p>买家会员名</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"missing-sku-order-item-col black\">\n\t\t\t\t\t\t<p>收货人姓名</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"missing-sku-order-item-col black\">\n\t\t\t\t\t\t<p>联系手机</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{\n\t\t\t\t\tkeys.map((item, index) =>\n\t\t\t\t\t\t<div key={index} className=\"missing-sku-order-item\">\n\t\t\t\t\t\t\t<div className=\"missing-sku-order-item-col\">\n\t\t\t\t\t\t\t\t<p>{list[item]['买家会员名']}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"missing-sku-order-item-col\">\n\t\t\t\t\t\t\t\t<p>{list[item]['收货人姓名']}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"missing-sku-order-item-col\">\n\t\t\t\t\t\t\t\t<p>{list[item]['联系手机']}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</div>\n\t\t</Modal>\n\t)\n}\n\nexport default Index\n\n\n","import React from 'react'\nimport Modal from '../../../components/Modal'\nimport './index.scss'\n\nfunction Index(props) {\n\tconst { close, list } = props\n\tconst keys = Object.keys(list)\n\treturn (\n\t\t<Modal close={close} style={{ width: '820px', height: keys.length >= 10 ? '602px' : `${keys.length * 60 + 2}px` }}>\n\t\t\t<div className=\"missing-sku-order\">\n\t\t\t\t<div className=\"missing-sku-order-item\">\n\t\t\t\t\t<div className=\"missing-sku-order-item-col black\">\n\t\t\t\t\t\t<p>买家会员名</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"missing-sku-order-item-col black\">\n\t\t\t\t\t\t<p>收货人姓名</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"missing-sku-order-item-col black\">\n\t\t\t\t\t\t<p>联系手机</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{\n\t\t\t\t\tkeys.map((item, index) =>\n\t\t\t\t\t\t<div key={index} className=\"missing-sku-order-item\">\n\t\t\t\t\t\t\t<div className=\"missing-sku-order-item-col\">\n\t\t\t\t\t\t\t\t<p>{list[item]['买家会员名']}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"missing-sku-order-item-col\">\n\t\t\t\t\t\t\t\t<p>{list[item]['收货人姓名']}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"missing-sku-order-item-col\">\n\t\t\t\t\t\t\t\t<p>{list[item]['联系手机']}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</div>\n\t\t</Modal>\n\t)\n}\n\nexport default Index\n\n\n","import './index.scss'\nimport React, { useState } from 'react'\nimport Header from '../../components/Header'\nimport Container from '../../components/Container'\nimport MissingSku from './MissingSku'\nimport MissingSkuOrder from './MissingSkuOrder'\nimport MissingSkuProduct from './MissingSkuProduct'\nimport ReturnRatio from './ReturnRatio'\nimport UnpaidOrder from './UnpaidOrder'\nimport PaidAndCancelled from './PaidAndCancelled'\nimport XLSX from 'xlsx'\n\nfunction Index() {\n\tconst [isDropOver, setIsDropOver] = useState(false)\n\tconst [hasFiles, setHasFiles] = useState(false)\n\tconst [sum, setSum] = useState(0)\n\tconst [succeed, setSucceed] = useState(0)\n\tconst [closed, setClosed] = useState(0)\n\tconst [orderDetail, setOrderDetail] = useState({})\n\tconst [unpaidOrder, setUnpaidOrder] = useState({})\n\tconst [paidAndCancelled, setPaidAndCancelled] = useState({})\n\tconst [fake, setFake] = useState(0)\n\tconst [fakeSum, setFakeSum] = useState(0)\n\tconst [totalCost, setTotalCost] = useState(0)\n\tconst [missingSku, setMissingSku] = useState({})\n\tconst [missingSkuOrder, setMissingSkuOrder] = useState({})\n\tconst [missingSkuProduct, setMissingSkuProduct] = useState({})\n\tconst [showMissingSku, setShowMissingSku] = useState(false)\n\tconst [showMissingSkuOrder, setShowMissingSkuOrder] = useState(false)\n\tconst [showMissingSkuProduct, setShowMissingSkuProduct] = useState(false)\n\tconst [showReturnRatio, setShowReturnRatio] = useState(false)\n\tconst [showUnpaidOrder, setShowUnpaidOrder] = useState(false)\n\tconst [showPaidAndCancelled, setShowPaidAndCancelled] = useState(false)\n\n\tfunction dropHandler(e) {\n\t\te.preventDefault()\n\t\tsetIsDropOver(false)\n\n\t\tif (e.dataTransfer.items.length !== 4) {\n\t\t\treturn\n\t\t}\n\n\t\treadFiles(e.dataTransfer.items)\n\t}\n\n\tfunction dragOverHandler(e) {\n\t\te.preventDefault()\n\t\tsetIsDropOver(true)\n\t\tsetHasFiles(false)\n\n\t}\n\n\tfunction dragLeaveHandler(e) {\n\t\te.preventDefault()\n\t\tsetIsDropOver(false)\n\t}\n\n\tfunction readFiles(files) {\n\t\tlet skuSheet, orderSheet, productSheet, returnSheet\n\t\tfor (let i = 0; i < files.length; i++) {\n\t\t\tif (files[i].kind === 'file') {\n\t\t\t\tconst file = files[i].getAsFile()\n\t\t\t\tif (file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') {\n\t\t\t\t\tif (file.name === 'sku.xlsx') {\n\t\t\t\t\t\tskuSheet = file\n\t\t\t\t\t} else if (file.name === 'order.xlsx') {\n\t\t\t\t\t\torderSheet = file\n\t\t\t\t\t} else if (file.name === 'product.xlsx') {\n\t\t\t\t\t\tproductSheet = file\n\t\t\t\t\t} else if (file.name === 'return.xlsx') {\n\t\t\t\t\t\treturnSheet = file\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!skuSheet || !orderSheet || !productSheet || !returnSheet) {\n\t\t\treturn\n\t\t}\n\n\t\tconst p = [\n\t\t\treadFile(skuSheet),\n\t\t\treadFile(orderSheet),\n\t\t\treadFile(productSheet),\n\t\t\treadFile(returnSheet),\n\t\t]\n\n\t\tPromise.all(p).then((values) => {\n\t\t\tsetHasFiles(true)\n\t\t\tcalc(values[0], values[1], values[2], values[3])\n\t\t})\n\t}\n\n\tfunction readFile(file) {\n\t\treturn new Promise(resolve => {\n\t\t\tconst reader = new FileReader()\n\t\t\treader.addEventListener('load', (e) => {\n\t\t\t\tconst workbook = XLSX.read(new Uint8Array(e.target.result), { type: 'array' })\n\t\t\t\tconst xlsxData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]])\n\t\t\t\tresolve(xlsxData)\n\t\t\t}, false)\n\t\t\treader.readAsArrayBuffer(file)\n\t\t})\n\t}\n\n\tfunction calc(skuSheet, orderSheet, productSheet, returnSheet) {\n\t\tlet sum = 0\n\t\tlet succeed = 0\n\t\tlet closed = 0\n\t\tlet fake = 0\n\t\tlet fakeSum = 0\n\t\tlet fakeOrder = {}\n\t\tlet missingSkuOrder = {}\n\t\tlet missingSku = {}\n\t\tlet missingSkuProduct = {}\n\t\tlet totalCost = 0\n\t\tlet products = {}\n\t\tlet unpaidOrder = {}\n\t\tlet paidAndCancelled = {}\n\t\tlet orderDetail = {}\n\t\tlet returnDetail = {}\n\n\t\tfor (let i = 0; i < orderSheet.length; i++) {\n\t\t\tconst id = orderSheet[i]['订单编号']\n\n\t\t\tif (isFakeOrder(orderSheet[i]['商家备忘'])) {\n\t\t\t\tfakeOrder[id] = true\n\t\t\t}\n\n\t\t\tif (orderSheet[i]['订单关闭原因'] === '买家未付款') {\n\t\t\t\tunpaidOrder[id] = orderSheet[i]\n\t\t\t} else {\n\t\t\t\tif (orderSheet[i]['发货时间'] === 'null') {\n\t\t\t\t\tpaidAndCancelled[id] = orderSheet[i]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (let l = 0; l < returnSheet.length; l++) {\n\t\t\tconst title = returnSheet[l]['宝贝标题']\n\t\t\treturnDetail[returnSheet[l]['订单编号']] = {\n\t\t\t\tpayment: returnSheet[l]['买家实际支付金额'],\n\t\t\t\ttitle,\n\t\t\t\treturn: returnSheet[l]['买家退款金额'],\n\t\t\t\tsku: title.slice(title.length - 5)\n\t\t\t}\n\t\t}\n\n\n\t\tfor (let k = 0; k < skuSheet.length; k++) {\n\t\t\tconst sku = String(skuSheet[k]['商品编码'])\n\t\t\tif (sku !== 'undefined') {\n\t\t\t\tconst cost = skuSheet[k]['进价']\n\t\t\t\tconst shipping = skuSheet[k]['运费'] || 7\n\t\t\t\tif (cost) {\n\t\t\t\t\tproducts[sku] = {\n\t\t\t\t\t\tcost: cost + shipping,\n\t\t\t\t\t\ttitle: skuSheet[k]['商品简称']\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tmissingSku[sku] = skuSheet[k]['商品简称']\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (let j = 0; j < productSheet.length; j++) {\n\t\t\tconst id = productSheet[j]['主订单编号']\n\t\t\tlet longSku = String(productSheet[j]['商家编码'])\n\t\t\tlet sku = String(productSheet[j]['商家编码']).split('-')[0]\n\t\t\tconst payment = Number(productSheet[j]['买家实际支付金额'])\n\t\t\tconst title = productSheet[j]['标题']\n\n\t\t\tif (fakeOrder[id]) { // 刷单\n\t\t\t\tfakeSum = fakeSum + payment\n\t\t\t\tfake = fake + 1\n\t\t\t} else if (!paidAndCancelled[id]) { // 真实成交并且不是付款了未发货就退款的\n\t\t\t\tif (longSku === 'null') {\n\t\t\t\t\tif (missingSkuOrder[id]) {\n\t\t\t\t\t\tmissingSkuOrder[id].push(title)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmissingSkuOrder[id] = [title]\n\t\t\t\t\t}\n\t\t\t\t\tmissingSkuProduct[title] = true\n\n\t\t\t\t\tconst s = title.slice(title.length - 5)\n\t\t\t\t\tif (isNaN(Number(s))) { // 商品标题无sku\n\t\t\t\t\t\tsku = null\n\t\t\t\t\t} else { // 获取到商品标题上的sku\n\t\t\t\t\t\tsku = s\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (sku) {\n\t\t\t\t\tif (!orderDetail[sku]) {\n\t\t\t\t\t\torderDetail[sku] = {\n\t\t\t\t\t\t\ttotal: 0,\n\t\t\t\t\t\t\tsucceed: 0,\n\t\t\t\t\t\t\tclosed: 0,\n\t\t\t\t\t\t\ttitle: products[sku] ? products[sku].title : title\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (productSheet[j]['订单状态'] === '交易成功') {\n\t\t\t\t\t\t// 在退款表里再筛选一遍\n\t\t\t\t\t\tif (returnDetail[id]) {\n\t\t\t\t\t\t\tconst sku = returnDetail[id].sku\n\t\t\t\t\t\t\tif (!orderDetail[sku]) {\n\t\t\t\t\t\t\t\torderDetail[sku] = {\n\t\t\t\t\t\t\t\t\ttotal: 0,\n\t\t\t\t\t\t\t\t\tsucceed: 0,\n\t\t\t\t\t\t\t\t\tclosed: 0,\n\t\t\t\t\t\t\t\t\ttitle: products[sku] ? products[sku].title : title\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tclosed = closed + 1\n\t\t\t\t\t\t\torderDetail[sku].closed = orderDetail[sku].closed + 1\n\t\t\t\t\t\t\torderDetail[sku].total = orderDetail[sku].total + 1\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 成交总额\n\t\t\t\t\t\t\tsum = sum + payment\n\n\t\t\t\t\t\t\t// 宝贝成交数量\n\t\t\t\t\t\t\tsucceed = succeed + 1\n\t\t\t\t\t\t\torderDetail[sku].succeed = orderDetail[sku].succeed + 1\n\t\t\t\t\t\t\torderDetail[sku].total = orderDetail[sku].total + 1\n\n\t\t\t\t\t\t\t// 计算成本\n\t\t\t\t\t\t\tif (products[sku]) {\n\t\t\t\t\t\t\t\ttotalCost = totalCost + products[sku].cost\n\t\t\t\t\t\t\t} else if (products[longSku]) {\n\t\t\t\t\t\t\t\ttotalCost = totalCost + products[longSku].cost\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmissingSku[sku] = productSheet[j]['标题']\n\t\t\t\t\t\t\t\tmissingSkuProduct[productSheet[j]['标题']] = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclosed = closed + 1\n\t\t\t\t\t\torderDetail[sku].closed = orderDetail[sku].closed + 1\n\t\t\t\t\t\torderDetail[sku].total = orderDetail[sku].total + 1\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsetMissingSkuProduct(missingSkuProduct)\n\t\tsetOrderDetail(orderDetail)\n\t\tsetUnpaidOrder(unpaidOrder)\n\t\tsetPaidAndCancelled(paidAndCancelled)\n\t\tsetSum(sum)\n\t\tsetSucceed(succeed)\n\t\tsetClosed(closed)\n\t\tsetFake(fake)\n\t\tsetFakeSum(fakeSum)\n\t\tsetTotalCost(totalCost)\n\t\tsetMissingSku(missingSku)\n\t\tsetMissingSkuOrder(missingSkuOrder)\n\t}\n\n\tfunction isFakeOrder(mark) {\n\t\tif (mark) {\n\t\t\tif (mark === '1' || mark === '2' || mark.indexOf('微博') > -1) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\tfunction buildResults() {\n\t\tif (!hasFiles) {\n\t\t\treturn null\n\t\t}\n\n\t\tlet returnRatio = ''\n\t\tif (succeed + closed > 0) {\n\t\t\treturnRatio = `${(closed / (succeed + closed) * 100).toFixed(2)}%`\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">成交宝贝数量</p>\n\t\t\t\t\t<p className=\"excel-container-left-item-value\">{succeed}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">关闭宝贝数量</p>\n\t\t\t\t\t<p className=\"excel-container-left-item-value\">{closed}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">刷单宝贝数量</p>\n\t\t\t\t\t<p className=\"excel-container-left-item-value\">{fake}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">真实成交金额</p>\n\t\t\t\t\t<p className=\"excel-container-left-item-value\">{sum.toFixed(0)} </p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">刷单金额</p>\n\t\t\t\t\t<p className=\"excel-container-left-item-value\">{fakeSum.toFixed(0)}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">衣物成本 + 运费</p>\n\t\t\t\t\t<p className=\"excel-container-left-item-value\">{totalCost.toFixed(0)}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">毛利</p>\n\t\t\t\t\t<p className=\"excel-container-left-item-value\">{(sum - totalCost).toFixed(0)}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">退货率</p>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclassName={`excel-container-left-item-value${returnRatio ? ' excel-container-left-item-hover' : ''}`}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tif (returnRatio) {\n\t\t\t\t\t\t\t\tsetShowReturnRatio(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>{returnRatio}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">拍下未支付的订单</p>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclassName={`excel-container-left-item-value${Object.keys(unpaidOrder).length > 0 ? ' excel-container-left-item-hover' : ''}`}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tif (Object.keys(unpaidOrder).length > 0) {\n\t\t\t\t\t\t\t\tsetShowUnpaidOrder(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>{Object.keys(unpaidOrder).length}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">支付未发货的订单</p>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclassName={`excel-container-left-item-value${Object.keys(paidAndCancelled).length > 0 ? ' excel-container-left-item-hover' : ''}`}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tif (Object.keys(paidAndCancelled).length > 0) {\n\t\t\t\t\t\t\t\tsetShowPaidAndCancelled(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>{Object.keys(paidAndCancelled).length}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">错误或没有价格的 sku</p>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclassName={`excel-container-left-item-value${Object.keys(missingSku).length > 0 ? ' excel-container-left-item-hover' : ''}`}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tif (Object.keys(missingSku).length > 0) {\n\t\t\t\t\t\t\t\tsetShowMissingSku(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>{Object.keys(missingSku).length}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">含有错误 sku 的订单</p>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclassName={`excel-container-left-item-value${Object.keys(missingSkuOrder).length > 0 ? ' excel-container-left-item-hover' : ''}`}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tif (Object.keys(missingSkuOrder).length > 0) {\n\t\t\t\t\t\t\t\tsetShowMissingSkuOrder(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>{Object.keys(missingSkuOrder).length}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"excel-container-left-item\">\n\t\t\t\t\t<p className=\"excel-container-left-item-title\">含有错误 sku 的宝贝</p>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclassName={`excel-container-left-item-value${Object.keys(missingSkuProduct).length > 0 ? ' excel-container-left-item-hover' : ''}`}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tif (Object.keys(missingSkuProduct).length > 0) {\n\t\t\t\t\t\t\t\tsetShowMissingSkuProduct(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>{Object.keys(missingSkuProduct).length}</p>\n\t\t\t\t</div>\n\t\t\t</>\n\t\t)\n\t}\n\n\treturn (\n\t\t<div className=\"excel\">\n\t\t\t<Header />\n\t\t\t<Container>\n\t\t\t\t{showReturnRatio && <ReturnRatio list={orderDetail} close={() => setShowReturnRatio(false)} />}\n\t\t\t\t{showMissingSku && <MissingSku list={missingSku} close={() => setShowMissingSku(false)} />}\n\t\t\t\t{showMissingSkuOrder && <MissingSkuOrder list={missingSkuOrder} close={() => setShowMissingSkuOrder(false)} />}\n\t\t\t\t{showMissingSkuProduct && <MissingSkuProduct list={missingSkuProduct} close={() => setShowMissingSkuProduct(false)} />}\n\t\t\t\t{showUnpaidOrder && <UnpaidOrder list={unpaidOrder} close={() => setShowUnpaidOrder(false)} />}\n\t\t\t\t{showPaidAndCancelled && <PaidAndCancelled list={paidAndCancelled} close={() => setShowPaidAndCancelled(false)} />}\n\t\t\t\t<div className=\"excel-container\">\n\t\t\t\t\t<div className=\"excel-container-left\">\n\t\t\t\t\t\t{buildResults()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"excel-container-right\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tstyle={isDropOver ? { backgroundColor: 'rgba(170, 172, 247,.8)', color: '#fff' } : {}}\n\t\t\t\t\t\t\tclassName=\"excel-container-right-upload\"\n\t\t\t\t\t\t\tonDrop={(e) => dropHandler(e)}\n\t\t\t\t\t\t\tonDragOver={(e) => dragOverHandler(e)}\n\t\t\t\t\t\t\tonDragLeave={(e) => dragLeaveHandler(e)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<p>把四个个文件拖到这里:</p>\n\t\t\t\t\t\t\t<p>淘宝上下载的三个原始表格</p>\n\t\t\t\t\t\t\t<p>1. 重命名为 order.xlsx 的订单表格（去掉密码）</p>\n\t\t\t\t\t\t\t<p>2. 重命名为 product.xlsx 的宝贝表格（将 csv 转成 xlsx）</p>\n\t\t\t\t\t\t\t<p>3. 重命名为 return.xlsx 的退款表格（将 xls 转成 xlsx）</p>\n\t\t\t\t\t\t\t<p>和命名为 sku.xlsx 的 sku 表格</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Container>\n\t\t</div>\n\t)\n}\n\nexport default Index","import './index.scss'\nimport React from 'react'\nimport Header from '../../components/Header'\nimport Container from '../../components/Container'\n\nfunction Index() {\n\treturn (\n\t\t<div className=\"home\">\n\t\t\t<Header />\n\t\t\t<Container>\n\t\t\t\t<div className=\"home-container\">\n\t\t\t\t\t<div className=\"origami_bird_box\">\n\t\t\t\t\t\t<div className=\"origami_bird\">\n\t\t\t\t\t\t\t<div className=\"origami_bird_body\">\n\t\t\t\t\t\t\t\t<div className=\"origami_bird_head\"></div>\n\t\t\t\t\t\t\t\t<div className=\"origami_bird_wing_left\">\n\t\t\t\t\t\t\t\t\t<div className=\"origami_bird_wing_left_top\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"origami_bird_wing_right\">\n\t\t\t\t\t\t\t\t\t<div className=\"origami_bird_wing_right_top\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"origami_bird_tail_left\"></div>\n\t\t\t\t\t\t\t\t<div className=\"origami_bird_tail_right\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Container>\n\t\t</div>\n\t)\n}\n\nexport default Index\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport reportWebVitals from './reportWebVitals'\nimport { BrowserRouter, Routes, Route } from 'react-router-dom'\nimport MergeImages from './pages/MergeImages'\nimport CropImages from './pages/CropImages'\nimport Excel from './pages/Excel'\nimport Home from './pages/Home'\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<BrowserRouter>\n\t\t\t<Routes>\n\t\t\t\t<Route path=\"/\">\n\t\t\t\t\t<Route index element={<Home />} />\n\t\t\t\t\t<Route path=\"/merge\" element={<MergeImages />} />\n\t\t\t\t\t<Route path=\"/crop\" element={<CropImages />} />\n\t\t\t\t\t<Route path=\"/excel\" element={<Excel />} />\n\t\t\t\t</Route>\n\t\t\t</Routes>\n\t\t</BrowserRouter>\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}